<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>読み上げ</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
            padding: 20px; 
            max-width: 600px; 
            margin: 0 auto; 
            background-color: #f4f4f9;
        }
        h2 { text-align: center; color: #333; }
        
        textarea { 
            width: 100%; 
            height: 400px; 
            font-size: 16px; 
            padding: 15px; 
            margin-bottom: 20px; 
            border-radius: 12px; 
            border: 1px solid #ddd; 
            box-sizing: border-box; /* 枠からはみ出し防止 */
            resize: vertical;
        }

        /* スピード調整エリア */
        .settings {
            background: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        input[type="range"] { flex-grow: 1; margin: 0 15px; }

        /* ボタンエリア */
        .buttons { display: flex; gap: 10px; }
        
        button { 
            border: none; 
            padding: 15px; 
            font-size: 16px; 
            font-weight: bold;
            border-radius: 50px; 
            cursor: pointer; 
            transition: opacity 0.2s;
            flex: 1; /* 横並びで均等に広げる */
        }
        button:active { opacity: 0.7; }

        /* 再生ボタン（青） */
        .btn-play { background-color: #007bff; color: white; }
        
        /* 停止ボタン（赤） */
        .btn-stop { background-color: #dc3545; color: white; }

    </style>
</head>
<body>

    <h2>マイ読み上げアプリ v2</h2>

    <textarea id="text-input" placeholder="ここにテキストを入力してください..."></textarea>

    <div class="settings">
        <label>速度: <span id="rate-val">2.0</span></label>
        <input type="range" id="rate" min="0.5" max="3.0" step="0.1" value="2.0" oninput="updateRateVal()">
    </div>

    <div class="buttons">
        <button class="btn-play" onclick="speakText()">再生 ▶</button>
        <button class="btn-stop" onclick="stopText()">停止 ■</button>
    </div>

    <script>
        // 速度の数値をリアルタイム表示する関数
        function updateRateVal() {
            const rate = document.getElementById('rate').value;
            document.getElementById('rate-val').innerText = rate;
        }

        function speakText() {
            // もし既に喋っていたら一旦キャンセル（重複再生防止）
            window.speechSynthesis.cancel();

            const text = document.getElementById('text-input').value;
            if (!text) return; // 空なら何もしない

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'ja-JP';
            
            // スライダーの値を取得して適用
            const speed = document.getElementById('rate').value;
            utterance.rate = speed;

            window.speechSynthesis.speak(utterance);
        }

        function stopText() {
            // 読み上げを強制停止
            window.speechSynthesis.cancel();
        }
    </script>

</body>
</html>
